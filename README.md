# YOLO モザイク処理アプリケーション

YOLOv11を使用したインスタンスセグメンテーションのアノテーション、学習、推論（モザイク処理）を行うPySide6アプリケーションです。

## 機能

- **アノテーション機能**: ポリゴン形式でのインスタンスセグメンテーション用アノテーション
- **学習機能**: YOLOv11モデルの学習（GPU/CPU自動選択）
- **推論・モザイク処理**: 学習したモデルを使用した推論とモザイク処理

## セットアップ

1. 依存関係のインストール:
```bash
pip install -r requirements.txt
```

2. アプリケーションの起動:
```bash
python main.py
```

## 使用方法

### アノテーション
1. 「アノテーション」タブを選択
2. 「画像フォルダを選択」で画像を読み込み
3. 画像上で左クリックして点を配置
4. ダブルクリックまたはEnterキーでポリゴンを確定
5. 「アノテーションを保存」でYOLO形式で保存

### 学習
1. 「学習」タブを選択
2. データセット設定ファイル（data.yaml）を選択または作成
3. モデルとパラメータを設定
4. 「学習開始」をクリック

### 推論・モザイク処理
1. 「推論・モザイク処理」タブを選択
2. 学習済みモデルを選択
3. モザイクタイプを選択：
   - gaussian: ガウシアンブラー
   - pixelate: ピクセレート
   - blur: シンプルブラー
   - black: 黒塗りつぶし
   - white: 白塗りつぶし
   - tile: タイルモザイク（ピクセルサイズ指定可能）
4. 画像を選択して「推論実行」
5. 「モザイク適用」でモザイク処理を実行
6. 「画像を保存」で結果を保存

### バッチ処理
1. 「バッチ処理」ボタンをクリック
2. 入力フォルダを選択（PNG/JPG画像を含む）
3. 出力フォルダを選択
4. PNGメタデータ保持オプションをチェック（必要に応じて）
5. 処理の進行状況がダイアログに表示されます

## GPU対応
- Windows: NVIDIA RTX GPU（CUDA）
- Mac: Apple Silicon（Metal Performance Shaders）
- その他: CPU

## ディレクトリ構造
```
mosaic_app/
├── data/
│   ├── images/      # 画像データ
│   ├── annotations/ # アノテーションデータ
│   └── models/      # 学習済みモデル
├── src/
│   ├── ui/          # UIコンポーネント
│   ├── annotation/  # アノテーション機能
│   ├── training/    # 学習機能
│   ├── inference/   # 推論機能
│   └── utils/       # ユーティリティ
└── main.py          # エントリーポイント
```